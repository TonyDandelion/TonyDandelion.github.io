

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&quot;dark&quot;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="知无者">
  <meta name="keywords" content="">
  <title>Django 知识点 - 代码即艺术</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/monokai.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.3.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>代码即艺术</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/introduction/">
                <i class="iconfont icon-map"></i>
                入门
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/404page.html">
                <i class="iconfont icon-heartbeat"></i>
                公益404
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Django 知识点">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2016-07-18 01:50" pubdate>
        2016年7月18日 凌晨
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      7.2k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      111
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Django 知识点</h1>
            
            <div class="markdown-body">
              <p>Django是一个开放源代码的Web应用框架，由Python写成。采用了MVT的软件设计模式，即模型Model，视图View和模板Template。</p>
<a id="more"></a>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://www.ziqiangxuetang.com/django/django-tutorial.html">内容整理自自强学堂</a></p>
</blockquote>
<h1 id="数据迁移">数据迁移</h1>
<h2 id="导出的方法">导出的方法</h2>
<p>比如我们有一个项目叫 mysite, 里面有一个 app 叫 blog ,我们想导出 blog 的所有数据。<br />
<figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> manage.<span class="hljs-keyword">py</span> dumpdata blog &gt; blog_dump.json<br></code></pre></div></td></tr></table></figure> ## 数据导入,不需要指定 appname</p>
<figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> manage.<span class="hljs-keyword">py</span> loaddata blog_dump.json<br></code></pre></div></td></tr></table></figure>
<h1 id="多数据库连用">多数据库连用</h1>
<h2 id="每个app都可以单独设置一个数据库">每个app都可以单独设置一个数据库</h2>
<figure class="highlight vala"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vala"><span class="hljs-meta"># Database</span><br><span class="hljs-meta"># https://docs.djangoproject.com/en/1.8/ref/settings/#databases</span><br>DATABASES = &#123;<br>    <span class="hljs-string">&#x27;default&#x27;</span>: &#123;<br>        <span class="hljs-string">&#x27;ENGINE&#x27;</span>: <span class="hljs-string">&#x27;django.db.backends.sqlite3&#x27;</span>,<br>        <span class="hljs-string">&#x27;NAME&#x27;</span>: os.path.join(BASE_DIR, <span class="hljs-string">&#x27;db.sqlite3&#x27;</span>),<br>    &#125;,<br>    <span class="hljs-string">&#x27;db1&#x27;</span>: &#123;<br>        <span class="hljs-string">&#x27;ENGINE&#x27;</span>: <span class="hljs-string">&#x27;django.db.backends.postgresql_psycopg2&#x27;</span>,<br>        <span class="hljs-string">&#x27;NAME&#x27;</span>: <span class="hljs-string">&#x27;dbname1&#x27;</span>,<br>        <span class="hljs-string">&#x27;USER&#x27;</span>: <span class="hljs-string">&#x27;your_db_user_name&#x27;</span>,<br>        <span class="hljs-string">&#x27;PASSWORD&#x27;</span>: <span class="hljs-string">&#x27;yourpassword&#x27;</span>,<br>        <span class="hljs-string">&quot;HOST&quot;</span>: <span class="hljs-string">&quot;localhost&quot;</span>,<br>    &#125;,<br>    <span class="hljs-string">&#x27;db2&#x27;</span>: &#123;<br>        <span class="hljs-string">&#x27;ENGINE&#x27;</span>: <span class="hljs-string">&#x27;django.db.backends.postgresql_psycopg2&#x27;</span>,<br>        <span class="hljs-string">&#x27;NAME&#x27;</span>: <span class="hljs-string">&#x27;dbname2&#x27;</span>,<br>        <span class="hljs-string">&#x27;USER&#x27;</span>: <span class="hljs-string">&#x27;your_db_user_name&#x27;</span>,<br>        <span class="hljs-string">&#x27;PASSWORD&#x27;</span>: <span class="hljs-string">&#x27;yourpassword&#x27;</span>,<br>        <span class="hljs-string">&quot;HOST&quot;</span>: <span class="hljs-string">&quot;localhost&quot;</span>,<br>    &#125;,<br>&#125;<br> <br><span class="hljs-meta"># use multi-database in django</span><br><span class="hljs-meta"># add by WeizhongTu</span><br>DATABASE_ROUTERS = [<span class="hljs-string">&#x27;project_name.database_router.DatabaseAppsRouter&#x27;</span>]<br>DATABASE_APPS_MAPPING = &#123;<br>    # example:<br>    #<span class="hljs-string">&#x27;app_name&#x27;</span>:<span class="hljs-string">&#x27;database_name&#x27;</span>,<br>    <span class="hljs-string">&#x27;app1&#x27;</span>: <span class="hljs-string">&#x27;db1&#x27;</span>,<br>    <span class="hljs-string">&#x27;app2&#x27;</span>: <span class="hljs-string">&#x27;db2&#x27;</span>,<br>&#125;<br></code></pre></div></td></tr></table></figure>
<h2 id="使用指定的数据库来执行操作">使用指定的数据库来执行操作</h2>
<p>在查询的语句后面用 using(dbname) 来指定要操作的数据库即可</p>
<figure class="highlight vala"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vala"><span class="hljs-meta"># 查询</span><br>YourModel.objects.<span class="hljs-keyword">using</span>(<span class="hljs-string">&#x27;db1&#x27;</span>).all() <br>或者 YourModel.objects.<span class="hljs-keyword">using</span>(<span class="hljs-string">&#x27;db2&#x27;</span>).all()<br> <br><span class="hljs-meta"># 保存 或 删除</span><br>user_obj.save(<span class="hljs-keyword">using</span>=<span class="hljs-string">&#x27;new_users&#x27;</span>)<br>user_obj.delete(<span class="hljs-keyword">using</span>=<span class="hljs-string">&#x27;legacy_users&#x27;</span>)<br></code></pre></div></td></tr></table></figure>
<h2 id="多个数据库联用时数据导入导出">多个数据库联用时数据导入导出</h2>
<p><strong>如果不是defalut(默认数据库）要在命令后边加 --database=数据库对应的settings.py中的名称 如： --database=db1 或 --database=db2</strong></p>
<h3 id="数据库同步创建表">数据库同步（创建表）</h3>
<figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> manage.<span class="hljs-keyword">py</span> syncdb #同步默认的数据库，和原来的没有区别<br> <br>#同步数据库 db1 (注意：不是数据库名是db1,是settings.<span class="hljs-keyword">py</span>中的那个db1，不过你可以使这两个名称相同，容易使用)<br><span class="hljs-keyword">python</span> manage.<span class="hljs-keyword">py</span> syncdb --database=db1<br></code></pre></div></td></tr></table></figure>
<h3 id="数据导出">数据导出</h3>
<figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">python</span> manage.py dumpdata app<span class="hljs-number">1</span> --database=db<span class="hljs-number">1</span> &gt; app<span class="hljs-number">1</span>_fixture.json<br><span class="hljs-attribute">python</span> manage.py dumpdata app<span class="hljs-number">2</span> --database=db<span class="hljs-number">2</span> &gt; app<span class="hljs-number">2</span>_fixture.json<br><span class="hljs-attribute">python</span> manage.py dumpdata auth &gt; auth_fixture.json<br></code></pre></div></td></tr></table></figure>
<h3 id="数据库导入">数据库导入</h3>
<figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">python</span> manage.py loaddata app<span class="hljs-number">1</span>_fixture.json --database=db<span class="hljs-number">1</span><br><span class="hljs-attribute">python</span> manage.py loaddata app<span class="hljs-number">2</span>_fixture.json --database=db<span class="hljs-number">2</span><br></code></pre></div></td></tr></table></figure>
<h1 id="django-缓存系统-调优">Django 缓存系统 （调优）</h1>
<p><strong>缓存系统工作原理：</strong></p>
<blockquote>
<p>对于给定的网址，尝试从缓存中找到网址，如果页面在缓存中，直接返回缓存的页面，如果缓存中没有，一系列操作（比如查数据库）后，保存生成的页面内容到缓存系统以供下一次使用，然后返回生成的页面内容</p>
</blockquote>
<figure class="highlight 1c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs 1c">&#123;<br>    &#x27;default&#x27;: &#123;<br>        &#x27;BACKEND&#x27;: &#x27;django.core.cache.backends.locmem.LocMemCache&#x27;,<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<p><strong>也就是默认利用本地的内存来当缓存，速度很快。当然可能出来内存不够用的情况，其它的一些内建可用的 Backends 有</strong></p>
<figure class="highlight scheme"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scheme"><span class="hljs-symbol">&#x27;django.core.cache.backends.db.DatabaseCache</span>&#x27;<br><span class="hljs-symbol">&#x27;django.core.cache.backends.dummy.DummyCache</span>&#x27;<br><span class="hljs-symbol">&#x27;django.core.cache.backends.filebased.FileBasedCache</span>&#x27;<br><span class="hljs-symbol">&#x27;django.core.cache.backends.locmem.LocMemCache</span>&#x27;<br><span class="hljs-symbol">&#x27;django.core.cache.backends.memcached.MemcachedCache</span>&#x27;<br><span class="hljs-symbol">&#x27;django.core.cache.backends.memcached.PyLibMCCache</span>&#x27;<br></code></pre></div></td></tr></table></figure>
<p>利用文件系统来缓存：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">CACHES</span> = &#123;<br>    <span class="hljs-string">&#x27;default&#x27;</span>: &#123;<br>        <span class="hljs-string">&#x27;BACKEND&#x27;</span>: <span class="hljs-string">&#x27;django.core.cache.backends.filebased.FileBasedCache&#x27;</span>,<br>        <span class="hljs-string">&#x27;LOCATION&#x27;</span>: <span class="hljs-string">&#x27;/var/tmp/django_cache&#x27;</span>,<br>        <span class="hljs-string">&#x27;TIMEOUT&#x27;</span>: 600,<br>        <span class="hljs-string">&#x27;OPTIONS&#x27;</span>: &#123;<br>            <span class="hljs-string">&#x27;MAX_ENTRIES&#x27;</span>: 1000<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<p>利用数据库来缓存，利用命令创建相应的表：<code>python manage.py createcachetable cache_table_name</code></p>
<figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">CACHES</span> = &#123;<br>    <span class="hljs-string">&#x27;default&#x27;</span>: &#123;<br>        <span class="hljs-string">&#x27;BACKEND&#x27;</span>: <span class="hljs-string">&#x27;django.core.cache.backends.db.DatabaseCache&#x27;</span>,<br>        <span class="hljs-string">&#x27;LOCATION&#x27;</span>: <span class="hljs-string">&#x27;cache_table_name&#x27;</span>,<br>        <span class="hljs-string">&#x27;TIMEOUT&#x27;</span>: 600,<br>        <span class="hljs-string">&#x27;OPTIONS&#x27;</span>: &#123;<br>            <span class="hljs-string">&#x27;MAX_ENTRIES&#x27;</span>: 2000<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<p><strong>一般流程</strong></p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span>(<span class="hljs-params">request</span>):</span><br>    <span class="hljs-comment"># 读取数据库等 并渲染到网页</span><br>    <span class="hljs-comment"># 数据库获取的结果保存到 queryset 中</span><br>    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string">&#x27;index.html&#x27;</span>, &#123;<span class="hljs-string">&#x27;queryset&#x27;</span>:queryset&#125;)<br></code></pre></div></td></tr></table></figure>
<p>使用chache之后</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br><span class="hljs-keyword">from</span> django.views.decorators.cache <span class="hljs-keyword">import</span> cache_page<br> <br><span class="hljs-meta">@cache_page(<span class="hljs-params"><span class="hljs-number">60</span> * <span class="hljs-number">15</span></span>) </span><span class="hljs-comment"># 秒数，这里指缓存 15 分钟，不直接写900是为了提高可读性</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span>(<span class="hljs-params">request</span>):</span><br>    <span class="hljs-comment"># 读取数据库等 并渲染到网页</span><br>    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string">&#x27;index.html&#x27;</span>, &#123;<span class="hljs-string">&#x27;queryset&#x27;</span>:queryset&#125;)<br></code></pre></div></td></tr></table></figure>
<p><strong>Memcached 是目前 Django 可用的最快的缓存，另外，Django 还可以共享缓存。</strong></p>
<h1 id="django-生成静态页面-调优">Django 生成静态页面 （调优）</h1>
<p><strong>如果网站的流量过大，每次访问时都动态生成，执行SQL语句，消耗大量服务器资源，这时候可以考虑生成静态页面。把静态页面存储到本地，下次就直接访问静态页面就好了。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br><span class="hljs-keyword">from</span> django.template.loader <span class="hljs-keyword">import</span> render_to_string<br><span class="hljs-keyword">import</span> os<br> <br> <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">my_view</span>(<span class="hljs-params">request</span>):</span><br>    context = &#123;<span class="hljs-string">&#x27;some_key&#x27;</span>: <span class="hljs-string">&#x27;some_value&#x27;</span>&#125;<br>	<br>    static_html = <span class="hljs-string">&#x27;/path/to/static.html&#x27;</span><br>	 <span class="hljs-comment">#匹配静态文件</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(static_html):<br>        content = render_to_string(<span class="hljs-string">&#x27;template.html&#x27;</span>, context)<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(static_html, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> static_file:<br>            static_file.write(content)<br> <br>    <span class="hljs-keyword">return</span> render(request, static_html)<br></code></pre></div></td></tr></table></figure>
<p><strong>当用户访问时，如果判断没有静态页面就自动生成静态页面，然后返回静态文件，当文件存在的时候就不再次生成。</strong></p>
<blockquote>
<p>但是一般情况下都不需要生成静态页面，因为Django 有缓存功能，使用 Django Cache(缓存)就相当于把生成生成静态页面，而且还有自动更新的功能，比如30分钟刷新一下页面内容。</p>
</blockquote>
<h1 id="django安全">Django安全</h1>
<figure class="highlight django"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs django"><span class="xml">Django表单用在模板中的时候我们会加一句 </span><span class="hljs-template-tag">&#123;% <span class="hljs-name"><span class="hljs-name">csrf_token</span></span> %&#125;</span><br></code></pre></div></td></tr></table></figure>
<h1 id="django国际化">Django国际化</h1>
<p><strong>开启国际化的支持，需要在settings.py文件中设置</strong></p>
<figure class="highlight autoit"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs autoit">MIDDLEWARE_CLASSES = (<br>    ...<br>    <span class="hljs-string">&#x27;django.middleware.locale.LocaleMiddleware&#x27;</span>,<br>)<br> <br> <br>LANGUAGE_CODE = <span class="hljs-string">&#x27;en&#x27;</span><br>TIME_ZONE = <span class="hljs-string">&#x27;UTC&#x27;</span><br>USE_I18N = <span class="hljs-literal">True</span><br>USE_L10N = <span class="hljs-literal">True</span><br>USE_TZ = <span class="hljs-literal">True</span><br> <br>LANGUAGES = (<br>    (<span class="hljs-string">&#x27;en&#x27;</span>, (<span class="hljs-string">&#x27;English&#x27;</span>)),<br>    (<span class="hljs-string">&#x27;zh-cn&#x27;</span>, (<span class="hljs-string">&#x27;中文简体&#x27;</span>)),<br>    (<span class="hljs-string">&#x27;zh-tw&#x27;</span>, (<span class="hljs-string">&#x27;中文繁體&#x27;</span>)),<br>)<br> <br><span class="hljs-meta">#翻译文件所在目录，需要手工创建</span><br>LOCALE_PATHS = (<br>    os.path.join(BASE_DIR, <span class="hljs-string">&#x27;locale&#x27;</span>),<br>)<br> <br>TEMPLATE_CONTEXT_PROCESSORS = (<br>    ...<br>    <span class="hljs-string">&quot;django.core.context_processors.i18n&quot;</span>,<br>)<br></code></pre></div></td></tr></table></figure>
<p><strong>生成需要翻译的文件：</strong> <figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">django-admin.<span class="hljs-keyword">py</span> makemessages -<span class="hljs-keyword">l</span> zh-<span class="hljs-keyword">cn</span><br>django-admin.<span class="hljs-keyword">py</span> makemessages -<span class="hljs-keyword">l</span> zh-tw<br></code></pre></div></td></tr></table></figure> <strong>手工翻译 locale 中的文本后，我们需要编译一下，这样翻译才会生效</strong></p>
<figure class="highlight nsis"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nsis">django-<span class="hljs-literal">admin</span>.py compilemessages<br></code></pre></div></td></tr></table></figure>
<h1 id="django-session">Django session</h1>
<p>Django完全支持也匿名会话，简单说就是使用跨网页之间可以进行通讯，比如显示用户名，用户是否已经发表评论。session框架让你存储和获取访问者的数据信息，这些信息保存在服务器上（默认是数据库中），<strong>以 cookies 的方式发送和获取一个包含 session ID的值，并不是用cookies传递数据本身。</strong></p>
<h2 id="启用session">启用session</h2>
<p><strong>编辑settings.py中的一些配置</strong></p>
<p><strong>MIDDLEWARE_CLASSES</strong> 确保其中包含以下内容</p>
<figure class="highlight 1c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs 1c">&#x27;django.contrib.sessions.middleware.SessionMiddleware&#x27;,<br></code></pre></div></td></tr></table></figure>
<p>INSTALLED_APPS 是包含</p>
<figure class="highlight sml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sml"><span class="hljs-symbol">&#x27;django</span>.contrib.sessions&#x27;,<br></code></pre></div></td></tr></table></figure>
<p>这些是默认启用的。如果你不用的话，也可以关掉这个以节省一点服务器的开销。</p>
<p><strong>提示：您也可以配置使用比如 cache 来存储 session</strong></p>
<h2 id="在视图中使用-session">在视图中使用 session</h2>
<p>request.session 可以在视图中任何地方使用，它类似于python中的字典 session 默认有效时间为两周，可以在 settings.py 中修改默认值。</p>
<figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql"># 创建或修改 <span class="hljs-keyword">session</span>：<br>request.<span class="hljs-keyword">session</span>[key] = <span class="hljs-keyword">value</span><br># 获取 <span class="hljs-keyword">session</span>：<br>request.<span class="hljs-keyword">session</span>.<span class="hljs-keyword">get</span>(key,default=<span class="hljs-keyword">None</span>)<br># 删除 <span class="hljs-keyword">session</span><br>del request.<span class="hljs-keyword">session</span>[key] # 不存在时报错<br></code></pre></div></td></tr></table></figure>
<blockquote>
<p>一个不让用户评价两次的例子</p>
</blockquote>
<p>HttpResponse</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> django.http <span class="hljs-keyword">import</span> <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post_comment</span>(<span class="hljs-params">request, new_comment</span>):</span><br>    <span class="hljs-keyword">if</span> request.session.get(<span class="hljs-string">&#x27;has_commented&#x27;</span>, <span class="hljs-literal">False</span>):<br>        <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">&quot;You&#x27;ve already commented.&quot;</span>)<br>    c = comments.Comment(comment=new_comment)<br>    c.save()<br>    request.session[<span class="hljs-string">&#x27;has_commented&#x27;</span>] = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">&#x27;Thanks for your comment!&#x27;</span>)<br></code></pre></div></td></tr></table></figure>
<blockquote>
<p>一个简化登录的验证</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">login</span>(<span class="hljs-params">request</span>):</span><br>    m = Member.objects.get(username=request.POST[<span class="hljs-string">&#x27;username&#x27;</span>])<br>    <span class="hljs-keyword">if</span> m.password == request.POST[<span class="hljs-string">&#x27;password&#x27;</span>]:<br>        request.session[<span class="hljs-string">&#x27;member_id&#x27;</span>] = m.<span class="hljs-built_in">id</span><br>        <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">&quot;You&#x27;re logged in.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">&quot;Your username and password didn&#x27;t match.&quot;</span>)<br>         <br>         <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">logout</span>(<span class="hljs-params">request</span>):</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">del</span> request.session[<span class="hljs-string">&#x27;member_id&#x27;</span>]<br>    <span class="hljs-keyword">except</span> KeyError:<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">&quot;You&#x27;re logged out.&quot;</span>)<br></code></pre></div></td></tr></table></figure>
<h1 id="django传递数据给js">Django传递数据给JS</h1>
<p><strong>有时候我们想把一个 list 或者 dict 传递给 javascript，处理后显示到网页上，比如要用 js 进行可视化的数据。</strong></p>
<blockquote>
<p><strong>错误的使用方法</strong></p>
</blockquote>
<ul>
<li>view.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> unicode_literals<br><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br> <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">home</span>(<span class="hljs-params">request</span>):</span><br>    List = [<span class="hljs-string">&#x27;自强学堂&#x27;</span>, <span class="hljs-string">&#x27;渲染Json到模板&#x27;</span>]<br>    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string">&#x27;home.html&#x27;</span>, &#123;<span class="hljs-string">&#x27;List&#x27;</span>: List&#125;)<br></code></pre></div></td></tr></table></figure>
<ul>
<li>html</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="handlebars"><span class="xml">    var List = </span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">List</span> &#125;&#125;</span><span class="xml">;</span></span><br>    alert(List);<br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></div></td></tr></table></figure>
<p>如果直接这么做，传递到 js 的时候，<strong>网页的内容会被转义，得到的格式会报错。</strong></p>
<p>访问时会得到 Uncaught SyntaxError: <strong>Unexpected token ILLEGAL</strong></p>
<blockquote>
<p><strong>需要注意两点：</strong></p>
</blockquote>
<ol type="1">
<li>views.py中返回的函数中的值要用 json.dumps()处理<br />
</li>
<li>在网页上要加一个 safe 过滤器。</li>
</ol>
<blockquote>
<p><strong>正确的使用方法</strong></p>
</blockquote>
<ul>
<li>view.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br> <br><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> unicode_literals<br> <br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br> <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">home</span>(<span class="hljs-params">request</span>):</span><br>    List = [<span class="hljs-string">&#x27;自强学堂&#x27;</span>, <span class="hljs-string">&#x27;渲染Json到模板&#x27;</span>]<br>    Dict = &#123;<span class="hljs-string">&#x27;site&#x27;</span>: <span class="hljs-string">&#x27;自强学堂&#x27;</span>, <span class="hljs-string">&#x27;author&#x27;</span>: <span class="hljs-string">&#x27;涂伟忠&#x27;</span>&#125;<br>    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string">&#x27;home.html&#x27;</span>, &#123;<br>            <span class="hljs-string">&#x27;List&#x27;</span>: json.dumps(List),<br>            <span class="hljs-string">&#x27;Dict&#x27;</span>: json.dumps(Dict)<br>        &#125;)<br></code></pre></div></td></tr></table></figure>
<ul>
<li>html</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//列表</span><br><span class="hljs-keyword">var</span> List = &#123;&#123; List|safe &#125;&#125;;<br>alert(List);<br><span class="hljs-comment">//字典</span><br><span class="hljs-keyword">var</span> Dict = &#123;&#123; Dict|safe &#125;&#125;;<br>alert(Dict);<br></code></pre></div></td></tr></table></figure>
<h1 id="django遍历数组和字典的几种方法">Django遍历数组和字典的几种方法</h1>
<h2 id="遍历数组的三种方法">遍历数组的三种方法</h2>
<figure class="highlight plain"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascrip">var List &#x3D; &#123;&#123; List|safe &#125;&#125;;<br> <br>&#x2F;&#x2F;下面的代码把List的每一部分放到头部和尾部<br>$(&#39;#list&#39;).prepend(List[0]);<br>$(&#39;#list&#39;).append(List[1]);<br><br>console.log(&#39;--- 遍历 List 方法 1 ---&#39;)<br>for(i in List)&#123;<br>    console.log(List[i]);&#x2F;&#x2F; i为索引<br>&#125;<br><br>console.log(&#39;--- 遍历 List 方法 2 ---&#39;)<br>for (var i &#x3D; List.length - 1; i &gt;&#x3D; 0; i--) &#123;<br>    &#x2F;&#x2F; 鼠标右键，审核元素，选择 console 可以看到输入的值。<br>    console.log(List[i]);<br>&#125;;<br><br>console.log(&#39;--- 同时遍历索引和内容，使用 jQuery.each() 方法 ---&#39;)<br>$.each(List, function(index, item)&#123;<br>    console.log(index+&#39;   &#39;+item);<br>&#125;);<br></code></pre></div></td></tr></table></figure>
<h2 id="遍历字典的方法和字典的取值">遍历字典的方法和字典的取值</h2>
<figure class="highlight 1c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs 1c"><span class="hljs-comment">// 字典</span><br>var Dict = &#123;&#123; Dict<span class="hljs-string">|safe &#125;&#125;;</span><br>console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&quot;--- 两种字典的取值方式  ---&quot;</span>)<br>console.<span class="hljs-built_in">log</span>(Dict[&#x27;site&#x27;]);<br>console.<span class="hljs-built_in">log</span>(Dict.author);<br> <br>console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&quot;---  遍历字典  ---&quot;</span>);<br>for(i in Dict) &#123;<br>    console.<span class="hljs-built_in">log</span>(i + Dict[i]);<span class="hljs-comment">//注意，此处 i 为键值</span><br>&#125;<br></code></pre></div></td></tr></table></figure>
<h1 id="django使用ajax">Django使用Ajax</h1>
<h2 id="一个简单的例子获取单个数值">一个简单的例子，获取单个数值。</h2>
<blockquote>
<p>jQuery的get方法</p>
</blockquote>
<figure class="highlight arcade"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arcade">$.get(<span class="hljs-string">&#x27;API&#x27;</span>,&#123;<span class="hljs-string">&#x27;参数名1&#x27;</span>:参数值<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;参数名2&#x27;</span>:参数值<span class="hljs-number">2</span>&#125;,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">结果值</span>)</span>&#123;<br>	$(<span class="hljs-string">&#x27;接受返回数据的元素&#x27;</span>).html(结果值);<br>	$(<span class="hljs-string">&#x27;接受返回数据的元素&#x27;</span>).val(结果值);<br>&#125;)<br></code></pre></div></td></tr></table></figure>
<ul>
<li>view.py</li>
</ul>
<figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql"># coding:utf<span class="hljs-number">-8</span><br><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> unicode_literals<br><span class="hljs-keyword">import</span> <span class="hljs-type">json</span><br><span class="hljs-keyword">from</span> django.http <span class="hljs-keyword">import</span> HttpResponse<br><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br><br>def <span class="hljs-keyword">Add</span>(request):<br>	a = request.<span class="hljs-keyword">GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]<br>	b = request.<span class="hljs-keyword">GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>]	<br>	a = <span class="hljs-type">int</span>(a)<br>	b = <span class="hljs-type">int</span>(b)<br>	<span class="hljs-keyword">return</span> HttpResponse(str(a+b))<br></code></pre></div></td></tr></table></figure>
<ul>
<li>html</li>
</ul>
<figure class="highlight django"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs django"><span class="hljs-template-tag">&#123;% <span class="hljs-name"><span class="hljs-name">extends</span></span> &#x27;Base.html&#x27; %&#125;</span><span class="xml"> </span><span class="hljs-template-tag">&#123;% <span class="hljs-name"><span class="hljs-name">block</span></span> content %&#125;</span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>输入两个数字<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/add/&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;get&quot;</span>&gt;</span></span><br><span class="xml">	a: <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;a&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;a&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span><br><span class="xml">	b: <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;b&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;b&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span><br><span class="xml">	<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>result: <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;result&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="xml">	<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sum&quot;</span>&gt;</span>计算<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><br><span class="xml">	$(document).ready(function()&#123;</span><br><span class="xml">		$(&#x27;#sum&#x27;).click(function()&#123;</span><br><span class="xml">			var a = $(&#x27;#a&#x27;).val();</span><br><span class="xml">			var b = $(&#x27;#b&#x27;).val();</span><br><span class="xml">			//使用很重要的jQuery的get方法</span><br><span class="xml">			$.get(&#x27;/add/&#x27;,&#123;&#x27;a&#x27;:a,&#x27;b&#x27;:b&#125;,function(ret)&#123;</span><br><span class="xml">				$(&#x27;#result&#x27;).html(ret)</span><br><span class="xml">			&#125;)</span><br><span class="xml">		&#125;);</span><br><span class="xml">	&#125;);</span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/images/time.jpg&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span> /  &gt;</span> </span><span class="hljs-template-tag">&#123;% <span class="hljs-name"><span class="hljs-name">endblock</span></span> %&#125;</span><br></code></pre></div></td></tr></table></figure>
<h2 id="较复杂的例子传递列表和字典">较复杂的例子，传递列表和字典。</h2>
<blockquote>
<p>传递list</p>
</blockquote>
<p>传递一个数组或字典到网页，由JS处理，再显示出来。关键是利用jQuery的 <code>getJson</code> 方法，核心代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js">$.getJSON(<span class="hljs-string">&#x27;API&#x27;</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">结果值</span>)</span>&#123;<br>    <span class="hljs-comment">//返回值 ret 在这里是一个字典</span><br>    $(<span class="hljs-string">&#x27;#dict_result&#x27;</span>).append(ret.字典中的键名+<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br>    <span class="hljs-comment">//也可以用ret[&#x27;字典中的键名&#x27;]</span><br>&#125;);<br></code></pre></div></td></tr></table></figure>
<p>需要注意的是API可以这样来写，用 <code>urls.py</code> 中的 <code>name</code> 来获取是一个更好的方法！</p>
<figure class="highlight django"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs django"><span class="hljs-template-tag">&#123;% <span class="hljs-name"><span class="hljs-name">url</span></span> &#x27;ajax-list&#x27; %&#125;</span><br></code></pre></div></td></tr></table></figure>
<ul>
<li><code>view.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> django.http <span class="hljs-keyword">import</span> HttpResponse,JsonResponse<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ajax_list</span>(<span class="hljs-params">request</span>):</span><br>    a = <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>)<br>    <span class="hljs-comment"># return HttpResponse(json.dumps(a),content_type=&quot;application/json&quot;)</span><br>    <span class="hljs-comment">#Django1.6以后的写法</span><br>    <span class="hljs-keyword">return</span> JsonResponse(a,safe=<span class="hljs-literal">False</span>)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ajax_dict</span>(<span class="hljs-params">request</span>):</span><br>    name_dict = &#123;<span class="hljs-string">&#x27;twz&#x27;</span>:<span class="hljs-string">&#x27;Love python and Django&#x27;</span>,<span class="hljs-string">&#x27;zqxt&#x27;</span>:<span class="hljs-string">&#x27;I am teaching Django&#x27;</span>&#125;<br>    <span class="hljs-comment">#return HttpResponse(json.dumps(name_dict),content_type=&quot;application/json&quot;)</span><br>    <span class="hljs-comment">#Django1.6以后的写法</span><br>    <span class="hljs-keyword">return</span> JsonResponse(name_dict,safe=<span class="hljs-literal">False</span>)<br></code></pre></div></td></tr></table></figure>
<ul>
<li><code>html</code></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;list&#x27;</span>&gt;</span>Ajax加载字典<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;list_result&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;dict&#x27;</span>&gt;</span>Ajax加载列表<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dict_result&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br><span class="javascript">    $(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="javascript">        <span class="hljs-comment">// 列表 list</span></span><br><span class="javascript">        $(<span class="hljs-string">&#x27;#list&#x27;</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="javascript">            <span class="hljs-comment">// $.getJSON(&#x27;/ajax_list/&#x27;,function(ret)&#123;</span></span><br><span class="javascript">            $.getJSON(<span class="hljs-string">&#x27;&#123;% url &#x27;</span>ajax-list<span class="hljs-string">&#x27; %&#125;&#x27;</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ret</span>)</span>&#123;</span><br><span class="javascript">                <span class="hljs-comment">//返回值 ret 在这里是一个列表</span></span><br><span class="javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = ret.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;</span><br><span class="javascript">                  <span class="hljs-comment">// 把 ret 的每一项显示在网页上</span></span><br><span class="javascript">                  $(<span class="hljs-string">&#x27;#list_result&#x27;</span>).append(<span class="hljs-string">&#x27; &#x27;</span> + ret[i])</span><br>                &#125;;<br>            &#125;);<br>        &#125;);<br><span class="javascript">        <span class="hljs-comment">//字典dict</span></span><br><span class="javascript">        $(<span class="hljs-string">&#x27;#dict&#x27;</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="javascript">            $.getJSON(<span class="hljs-string">&#x27;/ajax_dict/&#x27;</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ret</span>)</span>&#123;</span><br><span class="javascript">                <span class="hljs-comment">//返回值 ret 在这里是一个字典</span></span><br><span class="javascript">                $(<span class="hljs-string">&#x27;#dict_result&#x27;</span>).append(ret.zqxt+<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="javascript">                <span class="hljs-comment">//也可以用ret[&#x27;twz&#x27;]</span></span><br>            &#125;);<br>        &#125;);     <br>    &#125;);<br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></div></td></tr></table></figure>
<blockquote>
<p>传递dict</p>
</blockquote>
<ul>
<li><code>view.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ajax_dict</span>(<span class="hljs-params">request</span>):</span><br>    name_dict = &#123;<span class="hljs-string">&#x27;twz&#x27;</span>:<span class="hljs-string">&#x27;Love python and Django&#x27;</span>,<span class="hljs-string">&#x27;zqxt&#x27;</span>:<span class="hljs-string">&#x27;I am teaching Django&#x27;</span>&#125;<br>    person_info_dict = [<br>    &#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;xiaoming&quot;</span>, <span class="hljs-string">&quot;age&quot;</span>:<span class="hljs-number">20</span>&#125;,<br>    &#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;tuweizhong&quot;</span>, <span class="hljs-string">&quot;age&quot;</span>:<span class="hljs-number">24</span>&#125;,<br>    &#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;xiaoli&quot;</span>, <span class="hljs-string">&quot;age&quot;</span>:<span class="hljs-number">33</span>&#125;<br>    ]<br><br>    <span class="hljs-comment">#return HttpResponse(json.dumps(name_dict),content_type=&quot;application/json&quot;)</span><br>    <span class="hljs-comment">#Django1.6以后的写法</span><br>    <span class="hljs-keyword">return</span> JsonResponse(person_info_dict,safe=<span class="hljs-literal">False</span>)<br></code></pre></div></td></tr></table></figure>
<ul>
<li><code>html</code></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;dict&#x27;</span>&gt;</span>Ajax加载字典<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dict_result&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br><span class="javascript">    $(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="javascript">        <span class="hljs-comment">//字典dict</span></span><br><span class="javascript">        $(<span class="hljs-string">&#x27;#dict&#x27;</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="javascript">            $.getJSON(<span class="hljs-string">&#x27;&#123;% url &#x27;</span>ajax-dict<span class="hljs-string">&#x27; %&#125;&#x27;</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ret</span>)</span>&#123;</span><br><span class="javascript">                $.each(ret,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i,item</span>)</span>&#123;</span><br><span class="javascript">                    $(<span class="hljs-string">&#x27;#list_result&#x27;</span>).append(i+<span class="hljs-string">&#x27;   &#x27;</span>+item.name+<span class="hljs-string">&#x27;   &#x27;</span>+item.age+<span class="hljs-string">&#x27;&lt;/br&gt;&#x27;</span>);</span><br>                &#125;);<br>            &#125;);<br>        &#125;); <br>    &#125;);<br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></div></td></tr></table></figure>
<h2 id="更复杂的例子ajax加载图片">更复杂的例子，Ajax加载图片。</h2>
<p><strong>图片是放置在与APP目录同层次的common_static文件夹的pics文件夹之中的。</strong></p>
<ul>
<li>html</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>请输入<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/add/&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;get&quot;</span>&gt;</span><br>    color:<br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;color&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;color&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;red&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span> number:<br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;number&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;number&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>result: <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;result&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;sum&#x27;</span>&gt;</span>提交<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://apps.bdimg.com/libs/jquery/1.11.1/jquery.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br><span class="javascript">$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">    $(<span class="hljs-string">&quot;#sum&quot;</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">        <span class="hljs-keyword">var</span> color = $(<span class="hljs-string">&quot;#color&quot;</span>).val();</span><br><span class="javascript">        <span class="hljs-keyword">var</span> number = $(<span class="hljs-string">&quot;#number&quot;</span>).val();</span><br><br><span class="javascript">        $.get(<span class="hljs-string">&quot;&#123;% url &#x27;get-pic&#x27; %&#125;&quot;</span>, &#123;</span><br><span class="javascript">            <span class="hljs-string">&#x27;color&#x27;</span>: color,</span><br><span class="javascript">            <span class="hljs-string">&#x27;number&#x27;</span>: number</span><br><span class="javascript">        &#125;, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ret</span>) </span>&#123;</span><br><span class="javascript">            $(<span class="hljs-string">&#x27;#result&#x27;</span>).html(<span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-comment">//清空前面的结果</span></span><br><span class="javascript">            $.each(ret, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index, item</span>) </span>&#123;</span><br><span class="javascript">                $(<span class="hljs-string">&#x27;#result&#x27;</span>).append(<span class="hljs-string">&#x27;&lt;img src=&quot;/static/pics/&#x27;</span> + item + <span class="hljs-string">&#x27;&quot;&gt;&#x27;</span>);</span><br>            &#125;)<br>        &#125;)<br>    &#125;);<br>&#125;);<br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></div></td></tr></table></figure>
<ul>
<li>view.py</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">def get_pic(request):<br>    color = request.GET.<span class="hljs-builtin-name">get</span>(<span class="hljs-string">&#x27;color&#x27;</span>)<br>    number = request.GET.<span class="hljs-builtin-name">get</span>(<span class="hljs-string">&#x27;number&#x27;</span>)<br>    name = <span class="hljs-string">&#x27;&#123;&#125;_&#123;&#125;&#x27;</span>.format(color, number)<br><br>    <span class="hljs-builtin-name">print</span> <span class="hljs-string">&quot;!&quot;</span><span class="hljs-number">*100</span><br>    # 过滤出符合要求的图片，假设是以输入的开头的都返回<br>    result_list = filter(lambda x: x.startswith(name), PICS)<br><br>    <span class="hljs-builtin-name">print</span> <span class="hljs-string">&#x27;result_list&#x27;</span>, result_list<br><br>    return HttpResponse(<br>        json.dumps(result_list),<br>        <span class="hljs-attribute">content_type</span>=<span class="hljs-string">&#x27;application/json&#x27;</span>)<br></code></pre></div></td></tr></table></figure>
<blockquote>
<p>注意<code>filter</code>和<code>format</code>的使用</p>
</blockquote>
<ul>
<li>urls.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> django.conf.urls <span class="hljs-keyword">import</span> patterns, include, url<br><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br>admin.autodiscover()<br><br>urlpatterns = patterns(<span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-comment"># Examples:</span><br>    url(<span class="hljs-string">r&#x27;^$&#x27;</span>, <span class="hljs-string">&#x27;tools.views.index&#x27;</span>, name=<span class="hljs-string">&#x27;home&#x27;</span>),<br>    url(<span class="hljs-string">r&#x27;^get_pic/$&#x27;</span>, <span class="hljs-string">&#x27;tools.views.get_pic&#x27;</span>, name=<span class="hljs-string">&#x27;get-pic&#x27;</span>),<br>    <span class="hljs-comment"># url(r&#x27;^blog/&#x27;, include(&#x27;blog.urls&#x27;)),</span><br><br>    url(<span class="hljs-string">r&#x27;^admin/&#x27;</span>, include(admin.site.urls)),<br>)<br><br></code></pre></div></td></tr></table></figure>
<h1 id="django-ajax-csrf认证">Django Ajax CSRF认证</h1>
<p>CSRF通过伪装来自受信任用户的请求来利用受信任的网站</p>
<p>Django 中自带了 防止CSRF攻击的功能，但是一些新手不知道如何使用，给自己编程带来了麻烦。常常会出现下面<strong>django csrf token missing or incorrect</strong>的错误。</p>
<p>GET 请求不需要 CSRF 认证，POST 请求需要正确认证才能得到正确的返回结果。<strong>一般在POST表单中加入</strong></p>
<figure class="highlight django"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs django"><span class="hljs-template-tag">&#123;% <span class="hljs-name"><span class="hljs-name">csrf_token</span></span> %&#125;</span><br></code></pre></div></td></tr></table></figure>
<p>完整代码如下</p>
<figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/post-url/&quot;</span>&gt;</span><br>    &#123;% csrf_token %&#125;<br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&#x27;zqxt&#x27;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;自强学堂学习Django技术&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></div></td></tr></table></figure>
<p><strong>使用Ajax调用的时候，就要麻烦一些。需要注意以下几点:</strong></p>
<ul>
<li>在视图中使用 render （而不要使用 render_to_response）</li>
<li>使用 jQuery 的 ajax 或者 post 之前 加入这个 js 代码：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript">jQuery(<span class="hljs-built_in">document</span>).ajaxSend(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event, xhr, settings</span>) </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCookie</span>(<span class="hljs-params">name</span>) </span>&#123;<br>        <span class="hljs-keyword">var</span> cookieValue = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.cookie &amp;&amp; <span class="hljs-built_in">document</span>.cookie != <span class="hljs-string">&#x27;&#x27;</span>) &#123;<br>            <span class="hljs-keyword">var</span> cookies = <span class="hljs-built_in">document</span>.cookie.split(<span class="hljs-string">&#x27;;&#x27;</span>);<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; cookies.length; i++) &#123;<br>                <span class="hljs-keyword">var</span> cookie = jQuery.trim(cookies[i]);<br>                <span class="hljs-comment">// Does this cookie string begin with the name we want?</span><br>                <span class="hljs-keyword">if</span> (cookie.substring(<span class="hljs-number">0</span>, name.length + <span class="hljs-number">1</span>) == (name + <span class="hljs-string">&#x27;=&#x27;</span>)) &#123;<br>                    cookieValue = <span class="hljs-built_in">decodeURIComponent</span>(cookie.substring(name.length + <span class="hljs-number">1</span>));<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> cookieValue;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sameOrigin</span>(<span class="hljs-params">url</span>) </span>&#123;<br>        <span class="hljs-comment">// url could be relative or scheme relative or absolute</span><br>        <span class="hljs-keyword">var</span> host = <span class="hljs-built_in">document</span>.location.host; <span class="hljs-comment">// host + port</span><br>        <span class="hljs-keyword">var</span> protocol = <span class="hljs-built_in">document</span>.location.protocol;<br>        <span class="hljs-keyword">var</span> sr_origin = <span class="hljs-string">&#x27;//&#x27;</span> + host;<br>        <span class="hljs-keyword">var</span> origin = protocol + sr_origin;<br>        <span class="hljs-comment">// Allow absolute or scheme relative URLs to same origin</span><br>        <span class="hljs-keyword">return</span> (url == origin || url.slice(<span class="hljs-number">0</span>, origin.length + <span class="hljs-number">1</span>) == origin + <span class="hljs-string">&#x27;/&#x27;</span>) ||<br>            (url == sr_origin || url.slice(<span class="hljs-number">0</span>, sr_origin.length + <span class="hljs-number">1</span>) == sr_origin + <span class="hljs-string">&#x27;/&#x27;</span>) ||<br>            <span class="hljs-comment">// or any other URL that isn&#x27;t scheme relative or absolute i.e relative.</span><br>            !(<span class="hljs-regexp">/^(\/\/|http:|https:).*/</span>.test(url));<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeMethod</span>(<span class="hljs-params">method</span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-regexp">/^(GET|HEAD|OPTIONS|TRACE)$/</span>.test(method));<br>    &#125;<br> <br>    <span class="hljs-keyword">if</span> (!safeMethod(settings.type) &amp;&amp; sameOrigin(settings.url)) &#123;<br>        xhr.setRequestHeader(<span class="hljs-string">&quot;X-CSRFToken&quot;</span>, getCookie(<span class="hljs-string">&#x27;csrftoken&#x27;</span>));<br>    &#125;<br>&#125;);<br></code></pre></div></td></tr></table></figure>
<p>更为优雅简洁的代码（<strong>不能写在 <code>*.js</code> 中，要直接写在模板文件中</strong>）：</p>
<ul>
<li><code>csrf.js</code> 放在 <code>static</code> 文件夹里面</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-comment">/*====== django ajax ======*/</span><br>jQuery(<span class="hljs-built_in">document</span>).ajaxSend(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event, xhr, settings</span>) </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCookie</span>(<span class="hljs-params">name</span>) </span>&#123;<br>        <span class="hljs-keyword">var</span> cookieValue = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.cookie &amp;&amp; <span class="hljs-built_in">document</span>.cookie != <span class="hljs-string">&#x27;&#x27;</span>) &#123;<br>            <span class="hljs-keyword">var</span> cookies = <span class="hljs-built_in">document</span>.cookie.split(<span class="hljs-string">&#x27;;&#x27;</span>);<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; cookies.length; i++) &#123;<br>                <span class="hljs-keyword">var</span> cookie = jQuery.trim(cookies[i]);<br>                <span class="hljs-comment">// Does this cookie string begin with the name we want?</span><br>                <span class="hljs-keyword">if</span> (cookie.substring(<span class="hljs-number">0</span>, name.length + <span class="hljs-number">1</span>) == (name + <span class="hljs-string">&#x27;=&#x27;</span>)) &#123;<br>                    cookieValue = <span class="hljs-built_in">decodeURIComponent</span>(cookie.substring(name.length + <span class="hljs-number">1</span>));<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> cookieValue;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sameOrigin</span>(<span class="hljs-params">url</span>) </span>&#123;<br>        <span class="hljs-comment">// url could be relative or scheme relative or absolute</span><br>        <span class="hljs-keyword">var</span> host = <span class="hljs-built_in">document</span>.location.host; <span class="hljs-comment">// host + port</span><br>        <span class="hljs-keyword">var</span> protocol = <span class="hljs-built_in">document</span>.location.protocol;<br>        <span class="hljs-keyword">var</span> sr_origin = <span class="hljs-string">&#x27;//&#x27;</span> + host;<br>        <span class="hljs-keyword">var</span> origin = protocol + sr_origin;<br>        <span class="hljs-comment">// Allow absolute or scheme relative URLs to same origin</span><br>        <span class="hljs-keyword">return</span> (url == origin || url.slice(<span class="hljs-number">0</span>, origin.length + <span class="hljs-number">1</span>) == origin + <span class="hljs-string">&#x27;/&#x27;</span>) ||<br>            (url == sr_origin || url.slice(<span class="hljs-number">0</span>, sr_origin.length + <span class="hljs-number">1</span>) == sr_origin + <span class="hljs-string">&#x27;/&#x27;</span>) ||<br>            <span class="hljs-comment">// or any other URL that isn&#x27;t scheme relative or absolute i.e relative.</span><br>            !(<span class="hljs-regexp">/^(\/\/|http:|https:).*/</span>.test(url));<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeMethod</span>(<span class="hljs-params">method</span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-regexp">/^(GET|HEAD|OPTIONS|TRACE)$/</span>.test(method));<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (!safeMethod(settings.type) &amp;&amp; sameOrigin(settings.url)) &#123;<br>        xhr.setRequestHeader(<span class="hljs-string">&quot;X-CSRFToken&quot;</span>, getCookie(<span class="hljs-string">&#x27;csrftoken&#x27;</span>));<br>    &#125;<br>&#125;);<br><span class="hljs-comment">/*======= django ajax end ======*/</span><br></code></pre></div></td></tr></table></figure>
<ul>
<li><code>html</code></li>
</ul>
<p>```` csrfmiddlewaretoken:  <figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml">代码集合<br>```html<br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/jquery.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br>    /*<br>          自强学堂 学习更多IT技术<br><span class="javascript">      http:<span class="hljs-comment">//www.ziqiangxuetang.com</span></span><br>    */<br><span class="javascript">    $(<span class="hljs-string">&#x27;document&#x27;</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="javascript">      $.ajaxSetup(&#123;</span><br>          data: &#123;<br><span class="handlebars"><span class="xml">              csrfmiddlewaretoken: &#x27;</span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">csrf_token</span> &#125;&#125;</span><span class="xml">&#x27;</span></span><br>          &#125;,<br>      &#125;);  <br>    &#125;)<br>    <br><br><span class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">select_drug</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">        <span class="hljs-keyword">var</span> drug = <span class="hljs-built_in">document</span>.forms[<span class="hljs-number">0</span>].drug;</span><br><span class="javascript">        <span class="hljs-keyword">var</span> drugs = <span class="hljs-string">&quot;&quot;</span>;</span><br><span class="javascript">        <span class="hljs-keyword">var</span> i;</span><br>        for (i = 0; i &lt; drug.length; i++) &#123;<br>            if (drug[i].checked) &#123;<br><span class="javascript">                drugs = drugs + drug[i].value + <span class="hljs-string">&quot; &quot;</span>;</span><br>            &#125;<br>        &#125;<br><br><span class="javascript">        $.post(<span class="hljs-string">&#x27;&#123;% url &quot;exam2014&quot; %&#125;&#x27;</span>, &#123;</span><br><span class="javascript">            <span class="hljs-string">&#x27;drugs&#x27;</span>: drugs</span><br><span class="javascript">        &#125;, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ret</span>) </span>&#123;</span><br><span class="javascript">            $(<span class="hljs-string">&#x27;#result&#x27;</span>).html(ret);</span><br>        &#125;)<br>    &#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></div></td></tr></table></figure></p>
<h1 id="django-sitemap-站点地图">Django Sitemap 站点地图</h1>
<p>Django 中自带了 sitemap框架，用来生成 xml 文件 <strong>sitemap 很重要</strong>，可以用来通知搜索引擎页面的地址，页面的重要性，<strong>帮助站点得到比较好的收录</strong>。</p>
<p><a target="_blank" rel="noopener" href="http://www.ziqiangxuetang.com/django/django-sitemap.html">自强学堂参考链接</a></p>
<h1 id="单元测试技术">单元测试技术</h1>
<p><strong>Django中有完善的单元测试</strong>，我们可以对开发的每一个功能进行单元测试，这样<strong>只要运行一个命令 python manage.py test，就可以测试功能是否正常。</strong></p>
<h2 id="python中的单元测试">Python中的单元测试</h2>
<blockquote>
<p><strong>关键格式</strong></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> unittest<br><br><span class="hljs-comment">#目标函数</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> 测试函数(<span class="hljs-params">参数值<span class="hljs-number">1</span>,参数值<span class="hljs-number">2</span>,....</span>):</span><br>	函数体<br><br><span class="hljs-comment">#编写测试类</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> 测试类名(<span class="hljs-params">unittest.TestCase</span>):</span><br>	<span class="hljs-function"><span class="hljs-keyword">def</span> 测试函数名(<span class="hljs-params">self</span>):</span><br>		self.assertEqual(测试函数(参数值<span class="hljs-number">1</span>,参数值<span class="hljs-number">2</span>,....),目标对比参数<span class="hljs-number">1</span>)<br><br>	<span class="hljs-function"><span class="hljs-keyword">def</span> 测试函数名1(<span class="hljs-params">self</span>):</span><br>		self.assertEqual(测试函数(参数值<span class="hljs-number">1</span>,参数值<span class="hljs-number">2</span>,....),目标对比参数<span class="hljs-number">2</span>)<br><br>	<span class="hljs-function"><span class="hljs-keyword">def</span> 测试函数名2(<span class="hljs-params">self</span>):</span><br>		self.assertEqual(测试函数(参数值<span class="hljs-number">1</span>,参数值<span class="hljs-number">2</span>,....),目标对比参数<span class="hljs-number">3</span>)	<br><br><span class="hljs-comment">#执行测试单元</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	unittest.main()<br><br></code></pre></div></td></tr></table></figure>
<blockquote>
<p><strong>实例：测试一个除法功能</strong></p>
</blockquote>
<ul>
<li>编写测试实例</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs reasonml">import unittest<br> <br>def division<span class="hljs-constructor">_funtion(<span class="hljs-params">x</span>, <span class="hljs-params">y</span>)</span>:<br>    return x<span class="hljs-operator"> / </span>y<br> <br><span class="hljs-keyword">class</span> <span class="hljs-constructor">TestDivision(<span class="hljs-params">unittest</span>.TestCase)</span>:<br>    def test<span class="hljs-constructor">_int(<span class="hljs-params">self</span>)</span>:<br>        self.<span class="hljs-keyword">assert</span><span class="hljs-constructor">Equal(<span class="hljs-params">division_funtion</span>(9, 3)</span>, <span class="hljs-number">3</span>)<br> <br>    def test<span class="hljs-constructor">_int2(<span class="hljs-params">self</span>)</span>:<br>        self.<span class="hljs-keyword">assert</span><span class="hljs-constructor">Equal(<span class="hljs-params">division_funtion</span>(9, 4)</span>, <span class="hljs-number">2.25</span>)<br> <br>    def test<span class="hljs-constructor">_float(<span class="hljs-params">self</span>)</span>:<br>        self.<span class="hljs-keyword">assert</span><span class="hljs-constructor">Equal(<span class="hljs-params">division_funtion</span>(4.2, 3)</span>, <span class="hljs-number">1.4</span>)<br> <br><span class="hljs-keyword">if</span> __name__<span class="hljs-operator"> == </span>&#x27;__main__&#x27;:<br>    unittest.main<span class="hljs-literal">()</span><br></code></pre></div></td></tr></table></figure>
<ul>
<li>运行测试效果</li>
</ul>
<p>有两个错误9/4=2！=2.25 以及4.2/3=1.4000000000000001 != 1.4</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">C:\Users\Tony\Desktop\VueTest&gt;python UniteTest.py<br><span class="hljs-title">.FF</span><br>======================================================================<br>FAIL: test_int1 (<span class="hljs-emphasis">__main__</span>.TestDivision)<br>----------------------------------------------------------------------<br>Traceback (most recent call last):<br><span class="hljs-code">  File &quot;UniteTest.py&quot;, line 13, in test_int1</span><br><span class="hljs-code">    self.assertEqual(division_function(9,4),2.25)</span><br>AssertionError: 2 != 2.25<br><br>======================================================================<br>FAIL: test_int2 (<span class="hljs-emphasis">__main__</span>.TestDivision)<br>----------------------------------------------------------------------<br>Traceback (most recent call last):<br><span class="hljs-code">  File &quot;UniteTest.py&quot;, line 16, in test_int2</span><br><span class="hljs-code">    self.assertEqual(division_function(4.2,3),1.4)</span><br>AssertionError: 1.4000000000000001 != 1.4<br><br>----------------------------------------------------------------------<br>Ran 3 tests in 0.002s<br><br>FAILED (failures=2)<br></code></pre></div></td></tr></table></figure>
<ul>
<li>进行相应的修改</li>
</ul>
<p><strong>设置浮点运算，保留到小数点后六位。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">division_funtion</span>(<span class="hljs-params">x, y</span>):</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">round</span>(<span class="hljs-built_in">float</span>(x) / y, <span class="hljs-number">6</span>)<br></code></pre></div></td></tr></table></figure>
<ul>
<li>输出结果</li>
</ul>
<p>完全没有错误了</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">C:\Users\Tony\Desktop\VueTest&gt;python UniteTest.py<br>...<br>-------------------------------------------------<br>Ran 3 tests in 0.001s<br><br>OK<br></code></pre></div></td></tr></table></figure>
<h2 id="django中的单元测试">Django中的单元测试</h2>
<p><strong>简单测试例子</strong></p>
<figure class="highlight reasonml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs reasonml">from django.test import TestCase<br>from myapp.models import Animal<br><br><span class="hljs-keyword">class</span> <span class="hljs-constructor">AnimalTestCase(TestCase)</span>:<br>    def set<span class="hljs-constructor">Up(<span class="hljs-params">self</span>)</span>:<br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Animal</span>.</span></span>objects.create(name=<span class="hljs-string">&quot;lion&quot;</span>, sound=<span class="hljs-string">&quot;roar&quot;</span>)<br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Animal</span>.</span></span>objects.create(name=<span class="hljs-string">&quot;cat&quot;</span>, sound=<span class="hljs-string">&quot;meow&quot;</span>)<br> <br>    def test<span class="hljs-constructor">_animals_can_speak(<span class="hljs-params">self</span>)</span>:<br>        <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;Animals that can speak are correctly identified&quot;</span><span class="hljs-string">&quot;&quot;</span><br>        lion = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Animal</span>.</span></span>objects.get(name=<span class="hljs-string">&quot;lion&quot;</span>)<br>        cat = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Animal</span>.</span></span>objects.get(name=<span class="hljs-string">&quot;cat&quot;</span>)<br>        self.<span class="hljs-keyword">assert</span><span class="hljs-constructor">Equal(<span class="hljs-params">lion</span>.<span class="hljs-params">speak</span>()</span>, &#x27;The lion says <span class="hljs-string">&quot;roar&quot;</span>&#x27;)<br>        self.<span class="hljs-keyword">assert</span><span class="hljs-constructor">Equal(<span class="hljs-params">cat</span>.<span class="hljs-params">speak</span>()</span>, &#x27;The cat says <span class="hljs-string">&quot;meow&quot;</span>&#x27;)<br></code></pre></div></td></tr></table></figure>
<h1 id="django上下文渲染器">Django上下文渲染器</h1>
<h2 id="简介">简介</h2>
<p><strong>有时候我们想把一个变量在多个模板之间共用，这时候就可以用 Django 上下文渲染器。</strong></p>
<ul>
<li>setting.py</li>
</ul>
<figure class="highlight sml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sml"><span class="hljs-type">TEMPLATES</span> = [<br>    &#123;<br>        <span class="hljs-symbol">&#x27;BACKEND&#x27;</span>: <span class="hljs-symbol">&#x27;django</span>.template.backends.django.<span class="hljs-type">DjangoTemplates&#x27;</span>,<br>        <span class="hljs-symbol">&#x27;DIRS&#x27;</span>: <span class="hljs-literal">[]</span>,<br>        <span class="hljs-symbol">&#x27;APP_DIRS&#x27;</span>: <span class="hljs-type">True</span>,<br>        <span class="hljs-symbol">&#x27;OPTIONS&#x27;</span>: &#123;<br>            <span class="hljs-symbol">&#x27;context_processors&#x27;</span>: [<br>                <span class="hljs-symbol">&#x27;django</span>.template.context_processors.debug&#x27;,<br>                <span class="hljs-symbol">&#x27;django</span>.template.context_processors.request&#x27;,<br>                <span class="hljs-symbol">&#x27;django</span>.contrib.auth.context_processors.auth&#x27;,<br>                <span class="hljs-symbol">&#x27;django</span>.contrib.messages.context_processors.messages&#x27;,<br>            ],<br>        &#125;,<br>    &#125;,<br>]<br></code></pre></div></td></tr></table></figure>
<p><strong>这里的 context_processors 中放了一系列的渲染器</strong>，上下文渲染器其实<strong>就是函数返回字典</strong>，这些值可以用在模板中。 <strong>request函数就是在返回一个字典</strong>，每一个模板中都可以使用这个字典中提供的 request 变量。</p>
<p>比如 在template 中 获取当前访问的用户的用户名：</p>
<figure class="highlight crmsh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs crmsh"><span class="hljs-keyword">User</span> <span class="hljs-title">Name</span>: &#123;&#123; request.user.username &#125;&#125;<br></code></pre></div></td></tr></table></figure>
<h2 id="动手写个上下文渲染器">动手写个上下文渲染器</h2>
<ul>
<li>1、新建一个项目，基于 Django 1.9，我们新建了 zqxt 项目和 blog 这个应用。把 blog 这个app 加入到 settings.py 中。<br />
</li>
<li>2、我们在 zqxt/zqxt/ 这个目录下（与settings.py 在一起）新建一个 context_processor.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">from</span> django.conf <span class="hljs-keyword">import</span> settings <span class="hljs-keyword">as</span> original_settings<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">settings</span>(<span class="hljs-params">request</span>):</span><br>    <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;settings&#x27;</span>: original_settings&#125;<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ip_address</span>(<span class="hljs-params">request</span>):</span><br>    <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;ip_address&#x27;</span>: request.META[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]&#125;<br></code></pre></div></td></tr></table></figure>
<ul>
<li>3、我们把新建的两个 上下文渲染器 加入到 settings.py 中：</li>
</ul>
<figure class="highlight sml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sml"><span class="hljs-type">TEMPLATES</span> = [<br>    &#123;<br>        <span class="hljs-symbol">&#x27;BACKEND&#x27;</span>: <span class="hljs-symbol">&#x27;django</span>.template.backends.django.<span class="hljs-type">DjangoTemplates&#x27;</span>,<br>        <span class="hljs-symbol">&#x27;DIRS&#x27;</span>: <span class="hljs-literal">[]</span>,<br>        <span class="hljs-symbol">&#x27;APP_DIRS&#x27;</span>: <span class="hljs-type">True</span>,<br>        <span class="hljs-symbol">&#x27;OPTIONS&#x27;</span>: &#123;<br>            <span class="hljs-symbol">&#x27;context_processors&#x27;</span>: [<br>                <span class="hljs-symbol">&#x27;django</span>.template.context_processors.debug&#x27;,<br>                <span class="hljs-symbol">&#x27;django</span>.template.context_processors.request&#x27;,<br>                <span class="hljs-symbol">&#x27;django</span>.contrib.auth.context_processors.auth&#x27;,<br>                <span class="hljs-symbol">&#x27;django</span>.contrib.messages.context_processors.messages&#x27;,<br> <br>                <span class="hljs-symbol">&#x27;zqxt</span>.context_processor.settings&#x27;,<br>                <span class="hljs-symbol">&#x27;zqxt</span>.context_processor.ip_address&#x27;,<br>            ],<br>        &#125;,<br>    &#125;,<br>]<br></code></pre></div></td></tr></table></figure>
<ul>
<li>4、修改 blog/views.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span>(<span class="hljs-params">reuqest</span>):</span><br>    <span class="hljs-keyword">return</span> render(reuqest, <span class="hljs-string">&#x27;blog/index.html&#x27;</span>)<br>    <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">columns</span>(<span class="hljs-params">request</span>):</span><br>    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string">&#x27;blog/columns.html&#x27;</span>)<br></code></pre></div></td></tr></table></figure>
<ul>
<li>5、新建两个模板文件，放在 zqxt/blog/template/blog/ 中</li>
</ul>
<p><strong>index.html</strong> <figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Blog Home Page<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br> <br>DEBUG: &#123;&#123; settings.DEBUG &#125;&#125;<br> <br>ip: &#123;&#123; ip_address &#125;&#125;<br></code></pre></div></td></tr></table></figure> <strong>columns.html</strong></p>
<figure class="highlight handlebars"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs handlebars"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Blog Columns<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="xml"> </span><br><span class="xml">DEBUG: </span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">settings.DEBUG</span> &#125;&#125;</span><br><span class="xml"> </span><br><span class="xml">ip: </span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">ip_address</span> &#125;&#125;</span><br></code></pre></div></td></tr></table></figure>
<ul>
<li>6、修改 zqxt/urls.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> django.conf.urls <span class="hljs-keyword">import</span> include, url<br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> blog <span class="hljs-keyword">import</span> views <span class="hljs-keyword">as</span> blog_views<br> <br>urlpatterns = [<br>    url(<span class="hljs-string">r&#x27;^blog_home/$&#x27;</span>, blog_views.index),<br>    url(<span class="hljs-string">r&#x27;^blog_columns/$&#x27;</span>, blog_views.columns),<br>    url(<span class="hljs-string">r&#x27;^admin/&#x27;</span>, include(admin.site.urls)),<br>]<br></code></pre></div></td></tr></table></figure>
<ul>
<li>7、打开开发服务器并访问这两个网址就能够查看到相同的数据了</li>
</ul>
<h1 id="django-通用视图">Django 通用视图</h1>
<p>通用视图就是在view中创造类，利用类本身的方法和继承自父类的方法来完成相关的功能。</p>
<h2 id="base-views">Base Views</h2>
<blockquote>
<p><strong><code>django.views.generic.base.View</code></strong></p>
</blockquote>
<p>这个类是通用类的基类，其它类都是继承自这个类，一般不会用到这个类，感觉用函数更简单些。 在urls.py中使用类视图的时候都是调用它的 <strong><code>.as_view()</code></strong>函数。</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># views.py</span><br><span class="hljs-keyword">from</span> django.http <span class="hljs-keyword">import</span> HttpResponse<br><span class="hljs-keyword">from</span> django.views.generic <span class="hljs-keyword">import</span> View<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyView</span>(<span class="hljs-params">View</span>):</span><br> <br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span>(<span class="hljs-params">self, request, *args, **kwargs</span>):</span><br>        <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">&#x27;Hello, World!&#x27;</span>)<br> <br><span class="hljs-comment"># urls.py</span><br><span class="hljs-keyword">from</span> django.conf.urls <span class="hljs-keyword">import</span> patterns, url<br> <br><span class="hljs-keyword">from</span> myapp.views <span class="hljs-keyword">import</span> MyView<br> <br>urlpatterns = patterns(<span class="hljs-string">&#x27;&#x27;</span>,<br>    url(<span class="hljs-string">r&#x27;^mine/$&#x27;</span>, MyView.as_view(), name=<span class="hljs-string">&#x27;my-view&#x27;</span>),<br>)<br></code></pre></div></td></tr></table></figure>
<blockquote>
<p><strong><code>django.views.generic.base.TemplateView</code></strong></p>
</blockquote>
<p>在 <code>get_context_data()</code> 函数中，可以传一些 额外内容 到 模板</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># views.py</span><br> <br><span class="hljs-keyword">from</span> django.views.generic.base <span class="hljs-keyword">import</span> TemplateView<br> <br><span class="hljs-keyword">from</span> articles.models <span class="hljs-keyword">import</span> Article<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HomePageView</span>(<span class="hljs-params">TemplateView</span>):</span><br> <br>    template_name = <span class="hljs-string">&quot;home.html&quot;</span><br> <br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_context_data</span>(<span class="hljs-params">self, **kwargs</span>):</span><br>        context = <span class="hljs-built_in">super</span>(HomePageView, self).get_context_data(**kwargs)<br>        context[<span class="hljs-string">&#x27;latest_articles&#x27;</span>] = Article.objects.<span class="hljs-built_in">all</span>()[:<span class="hljs-number">5</span>]<br>        <span class="hljs-keyword">return</span> context<br> <br> <br><span class="hljs-comment"># urls.py</span><br> <br><span class="hljs-keyword">from</span> django.conf.urls <span class="hljs-keyword">import</span> patterns, url<br> <br><span class="hljs-keyword">from</span> myapp.views <span class="hljs-keyword">import</span> HomePageView<br> <br>urlpatterns = patterns(<span class="hljs-string">&#x27;&#x27;</span>,<br>    url(<span class="hljs-string">r&#x27;^$&#x27;</span>, HomePageView.as_view(), name=<span class="hljs-string">&#x27;home&#x27;</span>),<br>)<br></code></pre></div></td></tr></table></figure>
<blockquote>
<p><strong><code>django.views.generic.base.RedirectView</code></strong></p>
</blockquote>
<p>用来进行跳转, 默认是永久重定向（301），可以直接在urls.py中使用，非常方便：</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> django.conf.urls <span class="hljs-keyword">import</span> patterns, url<br><span class="hljs-keyword">from</span> django.views.generic.base <span class="hljs-keyword">import</span> RedirectView<br> <br>urlpatterns = patterns(<span class="hljs-string">&#x27;&#x27;</span>,<br>    url(<span class="hljs-string">r&#x27;^go-to-django/$&#x27;</span>, RedirectView.as_view(url=<span class="hljs-string">&#x27;http://djangoproject.com&#x27;</span>), name=<span class="hljs-string">&#x27;go-to-django&#x27;</span>),<br>    url(<span class="hljs-string">r&#x27;^go-to-ziqiangxuetang/$&#x27;</span>, RedirectView.as_view(url=<span class="hljs-string">&#x27;http://www.ziqiangxuetang.com&#x27;</span>,permant=<span class="hljs-literal">False</span>), name=<span class="hljs-string">&#x27;go-to-zqxt&#x27;</span>),<br>)<br></code></pre></div></td></tr></table></figure>
<p>另外的用法，可以用来记录文章的点击次数</p>
<figure class="highlight nim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nim"><span class="hljs-comment"># views.py</span><br><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> get_object_or_404<br><span class="hljs-keyword">from</span> django.views.<span class="hljs-keyword">generic</span>.base <span class="hljs-keyword">import</span> <span class="hljs-type">RedirectView</span><br> <br><span class="hljs-keyword">from</span> articles.models <span class="hljs-keyword">import</span> <span class="hljs-type">Article</span><br> <br>class <span class="hljs-type">ArticleCounterRedirectView</span>(<span class="hljs-type">RedirectView</span>):<br> <br>    url = &#x27; <span class="hljs-comment"># 要跳转的网址，</span><br>    <span class="hljs-comment"># url 可以不给，用 pattern_name 和 get_redirect_url() 函数 来解析到要跳转的网址</span><br>     <br>    permanent = <span class="hljs-type">False</span> <span class="hljs-comment">#是否为永久重定向, 默认为 True</span><br>    query_string = <span class="hljs-type">True</span> <span class="hljs-comment"># 是否传递GET的参数到跳转网址，True时会传递，默认为 False</span><br>    pattern_name = &#x27;article-detail&#x27; <span class="hljs-comment"># 用来跳转的 URL, 看下面的 get_redirect_url() 函数</span><br> <br>     <br>    <span class="hljs-comment"># 如果url没有设定，此函数就会尝试用pattern_name和从网址中捕捉的参数来获取对应网址</span><br>    <span class="hljs-comment"># 即 reverse(pattern_name, args) 得到相应的网址，</span><br>    <span class="hljs-comment"># 在这个例子中是一个文章的点击数链接，点击后文章浏览次数加1，再跳转到真正的文章页面</span><br>    def get_redirect_url(self, *args, **kwargs):<br>         <span class="hljs-type">If</span> url <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">set</span>, get_redirect_url() tries to reverse the pattern_name <span class="hljs-keyword">using</span> what was captured <span class="hljs-keyword">in</span> the <span class="hljs-type">URL</span> (both named <span class="hljs-keyword">and</span> unnamed groups are used).<br>        article = get_object_or_404(<span class="hljs-type">Article</span>, pk=kwargs[&#x27;pk&#x27;])<br>        article.update_counter() <span class="hljs-comment"># 更新文章点击数，在models.py中实现</span><br>        <span class="hljs-keyword">return</span> super(<span class="hljs-type">ArticleCounterRedirectView</span>, self).get_redirect_url(*args, **kwargs)<br> <br> <br><span class="hljs-comment"># urls.py</span><br><span class="hljs-keyword">from</span> django.conf.urls <span class="hljs-keyword">import</span> patterns, url<br><span class="hljs-keyword">from</span> django.views.<span class="hljs-keyword">generic</span>.base <span class="hljs-keyword">import</span> <span class="hljs-type">RedirectView</span><br> <br><span class="hljs-keyword">from</span> article.views <span class="hljs-keyword">import</span> <span class="hljs-type">ArticleCounterRedirectView</span>, <span class="hljs-type">ArticleDetail</span><br> <br>urlpatterns = patterns(&#x27;&#x27;,<br> <br>    url(r&#x27;^counter/(?P&lt;pk&gt;\d+)/$&#x27;, <span class="hljs-type">ArticleCounterRedirectView</span>.as_view(), name=&#x27;article-counter&#x27;),<br>    url(r&#x27;^details/(?P&lt;pk&gt;\d+)/$&#x27;, <span class="hljs-type">ArticleDetail</span>.as_view(), name=&#x27;article-detail&#x27;),<br>)<br></code></pre></div></td></tr></table></figure>
<h2 id="generic-display-view">Generic Display View</h2>
<p><a target="_blank" rel="noopener" href="http://www.ziqiangxuetang.com/django/django-generic-views.html">参考链接</a></p>
<blockquote>
<p><strong>django.views.generic.detail.DetailView</strong></p>
</blockquote>
<p><strong><code>DetailView有以下方法</code></strong></p>
<p>1.dispatch()<br />
根据发送给view的请求类型分配post()方法或者get()方法，一般在默认情况下，带head的请求都是分配给get()方法处理的，但是如果你想向view发送带head的请求，而且在view处理请求的不是get()方法，可以重写get()方法。<br />
2.http_method_not_allowed()<br />
如果发送给view的方法是django不支持的，那么就会执行这个函数，它会返回django支持的http请求方法<br />
3.get_template_names()<br />
返回一个模板名字的列表，第一个找到的要渲染的目标模会被渲染<br />
4.get_slug_field()<br />
返回一个slug field的名字。然后slug会根据这个名字去查阅slug filed的值。<br />
5.get_queryset()<br />
返回一个QuerySet，包含了要展示在页面上的数据。<br />
6.get_object(queryset=None)<br />
返回单个对象，用于这个view将要展示的数据，如果返回的queryset是有效的，就用这个queryset，否则调用get_queryset()方法，去寻找一个pk_url_kwarg主键参数，如果有这个主键参数，就以此为基础去寻找相关的值，否则就用slug field方法去找相关的值<br />
7.get_context_object_name(obj)<br />
返回一个context variable name，包含页面要操作的数据。当 context_object_name没有被设置的时候，会自动使用model的小写作为 context_object_name，例如Article，article。<br />
8.get_context_data(**kwargs)<br />
返回一个上下文数据（context data），作为列表展示的对象。<br />
9.get()<br />
10.render_to_response()<br />
返回一个self.response_class对象，如果获得任何一个keyword参数，那么keyword参数就会被传递给self.response_class的构造函数。<br />
自动生成当前时间，使用DetailView将额外的数据传输到页面。</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># views.py</span><br><span class="hljs-keyword">from</span> django.views.generic.detail <span class="hljs-keyword">import</span> DetailView<br><span class="hljs-keyword">from</span> django.utils <span class="hljs-keyword">import</span> timezone<br> <br><span class="hljs-keyword">from</span> articles.models <span class="hljs-keyword">import</span> Article<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ArticleDetailView</span>(<span class="hljs-params">DetailView</span>):</span><br> <br>    model = Article <span class="hljs-comment"># 要显示详情内容的类</span><br>     <br>    template_name = <span class="hljs-string">&#x27;article_detail.html&#x27;</span> <br>    <span class="hljs-comment"># 模板名称，默认为 应用名/类名_detail.html（即 app/modelname_detail.html）</span><br> <br>    <span class="hljs-comment"># 在 get_context_data() 函数中可以用于传递一些额外的内容到网页</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_context_data</span>(<span class="hljs-params">self, **kwargs</span>):</span><br>        context = <span class="hljs-built_in">super</span>(ArticleDetailView, self).get_context_data(**kwargs)<br>        context[<span class="hljs-string">&#x27;now&#x27;</span>] = timezone.now()<br>        <span class="hljs-keyword">return</span> context<br>         <br>         <br><span class="hljs-comment"># urls.py</span><br><span class="hljs-keyword">from</span> django.conf.urls <span class="hljs-keyword">import</span> url<br> <br><span class="hljs-keyword">from</span> article.views <span class="hljs-keyword">import</span> ArticleDetailView<br> <br>urlpatterns = [<br>    url(<span class="hljs-string">r&#x27;^(?P&lt;slug&gt;[-_\w]+)/$&#x27;</span>, ArticleDetailView.as_view(), name=<span class="hljs-string">&#x27;article-detail&#x27;</span>),<br>]<br></code></pre></div></td></tr></table></figure>
<p>article_detail.html文件新建在app下的templates文件夹里面</p>
<figure class="highlight handlebars"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs handlebars"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>标题：</span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">object.title</span> &#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>内容：</span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">object.content</span> &#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>发表人: </span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">object.reporter</span> &#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>发表于: </span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">object.pub_date</span>|date &#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="xml"> </span><br><span class="xml"> </span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>日期: </span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">now</span>|date &#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br></code></pre></div></td></tr></table></figure>
<blockquote>
<p><strong><code>django.views.generic.list.ListView</code></strong></p>
</blockquote>
<p>ListView有以下几种方法： 1. dispatch()<br />
2. http_method_not_allowed()<br />
3. get_template_names()<br />
4. get_queryset()<br />
5. get_context_object_name()<br />
6. get_context_data()<br />
7. get()<br />
8. render_to_response()</p>
<p>view.py文件</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># views.py</span><br><span class="hljs-keyword">from</span> django.views.generic.<span class="hljs-built_in">list</span> <span class="hljs-keyword">import</span> ListView<br><span class="hljs-keyword">from</span> django.utils <span class="hljs-keyword">import</span> timezone<br> <br><span class="hljs-keyword">from</span> articles.models <span class="hljs-keyword">import</span> Article<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ArticleListView</span>(<span class="hljs-params">ListView</span>):</span><br> <br>    model = Article<br> <br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_context_data</span>(<span class="hljs-params">self, **kwargs</span>):</span><br>        context = <span class="hljs-built_in">super</span>(ArticleListView, self).get_context_data(**kwargs)<br>        context[<span class="hljs-string">&#x27;now&#x27;</span>] = timezone.now()<br>        <span class="hljs-keyword">return</span> context<br> <br><span class="hljs-comment"># urls.py:</span><br> <br><span class="hljs-keyword">from</span> django.conf.urls <span class="hljs-keyword">import</span> url<br> <br><span class="hljs-keyword">from</span> article.views <span class="hljs-keyword">import</span> ArticleListView<br> <br>urlpatterns = [<br>    url(<span class="hljs-string">r&#x27;^$&#x27;</span>, ArticleListView.as_view(), name=<span class="hljs-string">&#x27;article-list&#x27;</span>),<br>]<br></code></pre></div></td></tr></table></figure>
<p>html文件</p>
<figure class="highlight django"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs django"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>文章列表<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="hljs-template-tag">&#123;% <span class="hljs-name"><span class="hljs-name">for</span></span> article <span class="hljs-keyword">in</span> object_list %&#125;</span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123; article.pub_date|<span class="hljs-name">date</span> &#125;&#125;</span><span class="xml"> - </span><span class="hljs-template-variable">&#123;&#123; article.headline &#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="hljs-template-tag">&#123;% <span class="hljs-name"><span class="hljs-name">empty</span></span> %&#125;</span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>抱歉，目前还没有文章。<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="hljs-template-tag">&#123;% <span class="hljs-name"><span class="hljs-name">endfor</span></span> %&#125;</span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br></code></pre></div></td></tr></table></figure>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">
            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Python%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/">Python后端开发</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Django/">Django</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2017/03/17/MongoDB%E7%9B%B8%E5%85%B3/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">MongoDB相关</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2016/07/15/Vue.js%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                        <span class="hidden-mobile">Vue.js学习笔记</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments">
                
                
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_config = function() {
        this.page.url = 'http://example.com/2016/07/18/Django%E7%9F%A5%E8%AF%86%E7%82%B9/';
        this.page.identifier = '/2016/07/18/Django%E7%9F%A5%E8%AF%86%E7%82%B9/';
      };
      Fluid.utils.waitElementVisible('disqus_thread', function () {
        var d = document, s = d.createElement('script');
        s.src = '//' + 'codesisart' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', new Date());
        (d.head || d.body).appendChild(s);
      });
    </script>
    <noscript>Please enable JavaScript to view the
      <a target="_blank" href="https://disqus.com/?ref_noscript" rel="nofollow noopener noopener">comments powered by Disqus.</a>
    </noscript>
  </div>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>









  <script  src="https://cdn.jsdelivr.net/npm/mermaid@8.8.3/dist/mermaid.min.js" ></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({"theme":"default"});
    }
  </script>







<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>

<!-- <script type="text/javascript" src="/js/cdnjs.cloudflare.com_ajax_libs_mathjax_2.7.1_MathJax.js_config=TeX-MML-AM_CHTML"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!-- <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->


</body>
</html>
